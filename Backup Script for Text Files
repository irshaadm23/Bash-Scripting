#!/bin/bash

read -p "Enter source directory: " dir

if [ ! -d "$dir" ]; then
    echo "Directory does not exist."
    exit 1
fi

base_backup="${dir}_backup"
mkdir -p "$base_backup"

timestamp=$(date +'%F_%H-%M')
backup_dir="$base_backup/${dir}_${timestamp}"

# Exit if this specific backup already exists
if [ -d "$backup_dir" ]; then
    echo "Backup already exists: $backup_dir"
    exit 1
fi

mkdir "$backup_dir"

cp "$dir"/*.txt "$backup_dir"/

num_files_backed=$(find "$backup_dir" -maxdepth 1 -type f | wc -l)

echo "Backup directory created: $backup_dir"
echo "Backup complete! Files backed up: $num_files_backed"
